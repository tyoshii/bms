{% extends "layout/game/edit.twig" %}

{% macro inning_fraction(default) %}
<select class="IP IP_frac">
<option value="0">--</option>
{% for i in 0..2 %}
{% set value = i ~ '/3' %}

<option value="{{value}}" {%if value==default%}selected{%endif%}>{{i}}/3</option>
{% endfor %}
</select>
{% endmacro %}

{% macro result(player) %}
<select class="result">
<option value="">--</option>
<option value="win" {%if player.W    %}selected{%endif%}>勝</option>
<option value="lose" {%if player.L   %}selected{%endif%}>負</option>
<option value="save" {%if player.SV  %}selected{%endif%}>Ｓ</option>
<option value="hold" {%if player.HLD %}selected{%endif%}>Ｈ</option>
</select>
{% endmacro %}



{% block content %}

{# header #}
{{ parent() }}


{%if metum|length == 0%}
<div class="alert alert-warning">
<p>出場選手に投手がいません。</p>
<p>出場選手でポジションを確認するか、チーム管理者に問い合わせてください。</p>
</div>
{%endif%}

<table id="pitcher" class="table">
<thead>
<tr>
<th class="name">名前</th>
<th class="number">＃</th>
<th class="result">勝敗</th>
<th class="IP" colspan="2">投球回</th>
<th class="H">被安打</th>
<th class="SO">奪三振</th>
<th class="BB">四球</th>
<th class="HB">死球</th>
<th class="ER">自責点</th>
<th class="R">失点</th>
</tr>
</thead>
<tbody>

{% set already = [] %}

{% for player in metum %}

{%set stat = stats[player.player_id]%}

<tr>
<td class="name">
<span>{{player.name}}</span>
<data class="disable" data-type="player-id">{{player.player_id}}</data>
</td>
<td class="number">{{player.number}}</td>

{# 勝敗 #}
<td class="result">{{_self.result(stat)}}</td>

{# 投球回 #}
<td class="IP">
<input class="IP" min="0" type="number" value="{{stat.IP|default(0)}}">
</td>

{# 投球回 0/3 1/3 2/3 #}
<td class="IP_frac">
{{_self.inning_fraction(stat.IP_frac)}}
</td>

{# 被安打 #}
<td class="H">
<input class="H" type="number" min="0" value="{{stat.H|default(0)}}">
</td>

{# 奪三振 #}
<td class="SO">
<input class="SO" type="number" min="0" value="{{stat.SO|default(0)}}">
</td>

{# 与四死球 #}
<td class="BB">
<input class="BB" type="number" min="0" value="{{stat.BB|default(0)}}">
</td>
<td class="HB">
<input class="HB" type="number" min="0" value="{{stat.HB|default(0)}}">
</td>

{# 自責点 #}
<td class="ER">
<input class="ER" type="number" min="0" value="{{stat.ER|default(0)}}">
</td>

{# 失点 #}
<td class="R">
<input class="R" type="number" min="0" value="{{stat.R|default(0)}}">
</td>
</tr>

{% endfor %}

</tbody>
</table>

{%if game_status == 2%}
<div class="alert alert-success">
成績入力を完了している試合です。
</div>
{%else%}
<button class="btn btn-default" onClick="post_pitcher(true);">保存</button>
<button class="btn btn-success" onClick="post_pitcher(true, true);">完了</button>
{%endif%}

{% endblock content %}
