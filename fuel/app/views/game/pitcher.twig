{% extends "layout/game/edit.twig" %}

{% macro inning_fraction(default) %}
<select class="inning fraction">
<option value="0">--</option>
{% for i in 0..2 %}
{% set value = i ~ '/3' %}

<option value="{{value}}" {%if value==default%}selected{%endif%}>{{i}}/3</option>
{% endfor %}
</select>
{% endmacro %}

{% macro result(player) %}
<select class="result">
<option value="">--</option>
<option value="win" {%if player.W    %}selected{%endif%}>勝</option>
<option value="lose" {%if player.L   %}selected{%endif%}>負</option>
<option value="save" {%if player.SV  %}selected{%endif%}>Ｓ</option>
<option value="hold" {%if player.HLD %}selected{%endif%}>Ｈ</option>
</select>
{% endmacro %}



{% block content %}

{# header #}
{{ parent() }}

<table id="pitcher" class="table">
<thead>
<tr>
<th class="name">名前</th>
<th class="number">＃</th>
<th class="result">勝敗</th>
<th class="inning" colspan="2">投球回</th>
<th class="hianda">被安打</th>
<th class="sanshin">奪三振</th>
<th class="shishikyuu">与四死球</th>
<th class="earned-runs">自責点</th>
<th class="runs">失点</th>
</tr>
</thead>
<tbody>

{% set already = [] %}

{% for player in metum %}

{%set stat = stats[player.player_id]%}

<tr>
<td class="name">
<span>{{player.name}}</span>
<data class="member-id disable">{{player.player_id}}</data>
</td>
<td class="number">{{player.number}}</td>

{# 勝敗 #}
<td class="result">{{_self.result(stat)}}</td>

{# 投球回 #}
<td class="inning">
<input class="inning_int" min="0" type="number" value="{{stat.IP|default(0)}}">
</td>

{# 投球回 0/3 1/3 2/3 #}
<td class="inning">
{{_self.inning_fraction(stat.IP_frac)}}
</td>

{# 被安打 #}
<td class="hianda">
<input class="hianda" type="number" min="0" value="{{stat.H|default(0)}}">
</td>

{# 奪三振 #}
<td class="sanshin">
<input class="sanshin" type="number" min="0" value="{{stat.SO|default(0)}}">
</td>

{# 与四死球 #}
<td class="shishikyuu">
<input class="shishikyuu" type="number" min="0" value="{{stat.BB|default(0)}}">
</td>

{# 自責点 #}
<td class="earned-runs">
<input class="earned-runs" type="number" min="0" value="{{stat.ER|default(0)}}">
</td>

{# 失点 #}
<td class="runs">
<input class="runs" type="number" min="0" value="{{stat.R|default(0)}}">
</td>
</tr>

{% endfor %}

</tbody>
</table>

<button class="btn btn-success" onClick="post_pitcher(true);">登録</button>

{% endblock content %}

{% block js %}

{{ parent() }}

<script>
$(document).ready(function() {
    setTimeout("autosave('pitcher');", 30000);
});
</script>
{% endblock %}
