{% extends "layout/game/edit.twig" %}

{% block content %}

{# header #}
{{ parent() }}

{%for batter in metum%}

<div class="batter-stats-container {%if not loop.first%}disable{%endif%}" index="{{loop.index}}">

<data class="player-id disable">{{batter.player_id}}</data>

<table class="table batter-meta">
<thead>
<tr>
<th></th>
<th>打順</th>
<th>名前</th>
<th>背番号</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>
{%if not loop.first%}
<span class="glyphicon glyphicon-chevron-left" role="switch-batter" type="prev"></span>{%endif%}
</td>
<td>{{batter.order}}</td>
<td>{{batter.name}}</td>
<td>{{batter.number}}</td>
<td>
{%if not loop.last%}
<span class="glyphicon glyphicon-chevron-right" role="switch-batter" type="next"></span>{%endif%}
</td>
</tr>
</tbody>
</table>


{# 打席詳細 #}
{% set detail  = details[batter.player_id]  %}
<table class="table table-striped batter-detail">

<tr class="batter-detail-header">
<th></th>
<th>方向</th>
<th>種類</th>
<th>結果</th>
</tr>

{%for d in detail%}
<tr class="batter-detail-data" index="{{loop.index}}" player_id="{{batter.player_id}}">

{#打席#}
<td class="PA">第{{loop.index}}打席</td>

{#方向#}
<td>
<select role="direction">
<option value="0">--</option>
{%for i in 1..9%}
<option value="{{i}}" {%if i==d.direction%}selected{%endif%}>{{i}}</option>
{%endfor%}
</select>
</td>

{#種類#}
<td>
<select role="kind">
<option value="0">--</option>
<option value="1" {%if d.kind==1%}selected{%endif%}>ゴロ</option>
<option value="2" {%if d.kind==2%}selected{%endif%}>ライナー</option>
<option value="3" {%if d.kind==3%}selected{%endif%}>フライ</option>
</select>
</td>

{#結果#}
<td>
<select role="result">
<option value="0">--</option>
{%for res in results%}
<option value="{{res.id}}" {%if res.id==d.result_id%}selected{%endif%}>{{res.result}}</option>
{%endfor%}
</select>
</td>
</tr>

{%endfor%}{# for d in detail#}

{#打席追加/削除ボタン#}
<tfoot>
<tr>
<td colspan="4">
<div class="btn-group pull-left">
<button type="button" class="detail-add btn btn-info btn-xs">追加</button>
<button type="button" class="detail-del btn btn-danger btn-xs">削除</button>
</div>
</td>
</tr>
</tfoot>

</table>

{# 成績 #}
{# モバイル版では、打点・得点・盗塁・エラー、のみを表示 #}
{% set stats = hittings[batter.player_id] %}

<table class="table batter-stats">
<tbody>
<tr>

<th>打点</th>
<td>
<select role="RBI">
{%for i in 0..20%}
<option value="{{i}}" {%if i==stats.RBI%}selected{%endif%}>{{i}}</option>
{%endfor%}
</select>
</td>

<th>得点</th>
<td>
<select role="R">
{%for i in 0..20%}
<option value="{{i}}" {%if i==stats.R%}selected{%endif%}>{{i}}</option>
{%endfor%}
</select>
</td>

</tr>
<tr>

<th>盗塁</th>
<td>
<select role="SB">
{%for i in 0..20%}
<option value="{{i}}" {%if i==stats.SB%}selected{%endif%}>{{i}}</option>
{%endfor%}
</select>
</td>

<th>エラー</th>
<td>
<select role="E">
{%for i in 0..20%}
<option value="{{i}}" {%if i==fieldings[batter.player_id].E%}selected{%endif%}>{{i}}</option>
{%endfor%}
</select>
</td>

</tr>
</tbody>
</table>

</div>{# class="batter-stats-container" #}

{%endfor%}

{# 保存/决定ボタン #}
<div class="batter-stats-post">
<button type="button" class="btn btn-default" post_type="save">保存</button>
<button type="button" class="btn btn-success" post_type="complete">决定</button>
</div>

{% endblock content %}


{% block js %}
{{ parent() }}
<script type="text/javascript" src="/js/game/edit_mobile.js"></script>

<script>
$(document).ready(function() {
    setTimeout("autosave('batter');", 30000);
});
</script>
{% endblock %}


{%block css%}
{{parent()}}

<link rel="stylesheet" type="text/css" href="/css/bms_mobile.css">
{%endblock css%}
